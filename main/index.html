<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AI TTS Studio</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <style>
    @font-face {
      font-family: 'VCR-Mono';
      src: url('https://hebbkx1anhila5yf.public.blob.vercel-storage.com/VCR-Mono-tr1bRwVHOaRLV1Vzx4T8S0Ywpv9v4f.ttf') format('truetype');
    }
    
    @font-face {
      font-family: 'HelveticaNowDisplay-ExtBlk';
      src: url('https://hebbkx1anhila5yf.public.blob.vercel-storage.com/HelveticaNowDisplay-ExtBlk-whQStsXLgCPVFUHbr0SXizdhhOqWaj.ttf') format('truetype');
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'VCR-Mono', monospace;
      background: #000000;
      color: #888888;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      overflow-x: hidden;
      position: relative;
    }

    /* Added animated background particles */
    #particles-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      opacity: 0.3;
    }

    /* Enhanced main container with subtle glow */
    .main-container {
      width: 100%;
      max-width: 56rem;
      position: relative;
      z-index: 1;
    }

    /* Enhanced container with premium effects */
    .container {
      background: linear-gradient(145deg, #111111, #0a0a0a);
      padding: 40px;
      width: 100%;
      box-shadow: 
        0 20px 40px rgba(255, 0, 0, 0.15),
        0 0 60px rgba(255, 0, 0, 0.05),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
      border: 1px solid #222222;
      border-radius: 0;
      position: relative;
      overflow: hidden;
      backdrop-filter: blur(10px);
    }

    /* Added subtle animated border glow */
    .container::before {
      content: '';
      position: absolute;
      top: -2px;
      left: -2px;
      right: -2px;
      bottom: -2px;
      background: linear-gradient(45deg, 
        transparent, 
        rgba(255, 0, 0, 0.1), 
        transparent, 
        rgba(255, 0, 0, 0.1), 
        transparent
      );
      border-radius: 0;
      z-index: -1;
      animation: borderGlow 4s linear infinite;
    }

    @keyframes borderGlow {
      0% { background-position: 0% 50%; }
      100% { background-position: 200% 50%; }
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
      position: relative;
    }

    /* Enhanced title with text glow effect */
    .title {
      font-family: 'HelveticaNowDisplay-ExtBlk', sans-serif;
      color: #ff0000;
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 10px;
      letter-spacing: -0.025em;
      text-shadow: 
        0 0 20px rgba(255, 0, 0, 0.3),
        0 0 40px rgba(255, 0, 0, 0.1);
      position: relative;
    }

    /* Added floating particles around title */
    .title::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 200px;
      height: 200px;
      background: radial-gradient(circle, rgba(255, 0, 0, 0.1) 0%, transparent 70%);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      z-index: -1;
      animation: pulse 3s ease-in-out infinite;
    }

    @keyframes pulse {
      0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.3; }
      50% { transform: translate(-50%, -50%) scale(1.2); opacity: 0.1; }
    }

    .subtitle {
      color: #888888;
      font-size: 1.1rem;
      max-width: 32rem;
      margin: 0 auto;
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 25px;
      margin-bottom: 30px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      opacity: 0;
      transform: translateY(20px);
      position: relative;
    }

    .form-group.full-width {
      grid-column: 1 / -1;
    }

    .label {
      display: block;
      margin-bottom: 8px;
      color: #cccccc;
      font-weight: 500;
      font-size: 0.875rem;
      letter-spacing: 0.025em;
      position: relative;
    }

    /* Enhanced inputs with premium styling */
    .input, .select, .textarea {
      width: 100%;
      padding: 15px;
      background: linear-gradient(145deg, #1a1a1a, #151515);
      border: 2px solid #333333;
      color: #ffffff;
      font-size: 16px;
      font-family: 'VCR-Mono', monospace;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      border-radius: 0;
      position: relative;
      box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    /* Enhanced select dropdown with better visibility and custom styling */
    .select {
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23ff0000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
      background-position: right 0.75rem center;
      background-repeat: no-repeat;
      background-size: 1.25rem;
      padding-right: 2.5rem;
      position: relative;
      z-index: 10;
    }

    /* Custom select dropdown options styling */
    .select option {
      background: #1a1a1a;
      color: #ffffff;
      padding: 10px;
      border: none;
    }

    .select option:hover {
      background: #ff0000;
      color: #ffffff;
    }

    .input:focus, .select:focus, .textarea:focus {
      outline: none;
      border-color: #ff0000;
      box-shadow: 
        0 0 0 3px rgba(255, 0, 0, 0.15),
        0 0 20px rgba(255, 0, 0, 0.1),
        inset 0 2px 4px rgba(0, 0, 0, 0.3);
      transform: translateY(-2px);
    }

    .textarea {
      min-height: 7rem;
      resize: vertical;
      font-family: 'VCR-Mono', monospace;
    }

    .controls {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 30px;
      flex-wrap: wrap;
    }

    /* Enhanced buttons with premium effects */
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 18px 24px;
      border: none;
      border-radius: 0;
      font-size: 18px;
      font-family: 'HelveticaNowDisplay-ExtBlk', sans-serif;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      text-decoration: none;
      position: relative;
      overflow: hidden;
      opacity: 0;
      transform: translateY(20px);
    }

    /* Enhanced primary button with red theme */
    .btn-primary {
      background: linear-gradient(135deg, #ff0000, #cc0000);
      color: white;
      box-shadow: 
        0 8px 16px rgba(255, 0, 0, 0.3),
        0 0 30px rgba(255, 0, 0, 0.1);
    }

    .btn-primary:hover:not(:disabled) {
      background: linear-gradient(135deg, #ff3333, #ff0000);
      transform: translateY(-4px);
      box-shadow: 
        0 12px 24px rgba(255, 0, 0, 0.4),
        0 0 40px rgba(255, 0, 0, 0.2);
    }

    .btn-primary:active {
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: linear-gradient(145deg, #1a1a1a, #151515);
      color: #cccccc;
      border: 2px solid #333333;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    }

    .btn-secondary:hover:not(:disabled) {
      border-color: #ff0000;
      color: #ffffff;
      background: linear-gradient(145deg, rgba(255, 0, 0, 0.1), rgba(255, 0, 0, 0.05));
      transform: translateY(-2px);
      box-shadow: 
        0 8px 16px rgba(0, 0, 0, 0.4),
        0 0 20px rgba(255, 0, 0, 0.1);
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }

    .status-container {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-left: auto;
    }

    /* Enhanced loader with red theme */
    .loader {
      width: 20px;
      height: 20px;
      border: 2px solid rgba(255, 0, 0, 0.3);
      border-top: 2px solid #ff0000;
      border-radius: 0;
      animation: spin 1s linear infinite;
      opacity: 0;
      display: none;
      box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .status-text {
      font-size: 14px;
      color: #888888;
      font-weight: 500;
    }

    /* Custom audio player to match theme */
    .custom-audio-player {
      background: linear-gradient(145deg, #1a1a1a, #151515);
      border: 2px solid #333333;
      border-radius: 0;
      padding: 20px;
      display: none;
      margin-bottom: 20px;
      box-shadow: 
        inset 0 2px 4px rgba(0, 0, 0, 0.3),
        0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .audio-controls {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 15px;
    }

    .play-pause-btn {
      width: 50px;
      height: 50px;
      background: linear-gradient(135deg, #ff0000, #cc0000);
      border: none;
      border-radius: 0;
      color: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 4px 8px rgba(255, 0, 0, 0.3);
    }

    .play-pause-btn:hover {
      background: linear-gradient(135deg, #ff3333, #ff0000);
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(255, 0, 0, 0.4);
    }

    .time-display {
      color: #cccccc;
      font-family: 'VCR-Mono', monospace;
      font-size: 14px;
      min-width: 100px;
    }

    .volume-control {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-left: auto;
    }

    .volume-slider {
      width: 80px;
      height: 4px;
      background: #333333;
      border-radius: 0;
      outline: none;
      -webkit-appearance: none;
      cursor: pointer;
    }

    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 16px;
      height: 16px;
      background: #ff0000;
      border-radius: 0;
      cursor: pointer;
      box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
    }

    .volume-slider::-moz-range-thumb {
      width: 16px;
      height: 16px;
      background: #ff0000;
      border-radius: 0;
      cursor: pointer;
      border: none;
      box-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
    }

    .progress-container {
      position: relative;
      height: 6px;
      background: #333333;
      border-radius: 0;
      cursor: pointer;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      background: linear-gradient(90deg, #ff0000, #ff3333);
      width: 0%;
      transition: width 0.1s ease;
      position: relative;
    }

    .progress-bar::after {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 4px;
      height: 100%;
      background: rgba(255, 255, 255, 0.8);
      box-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
    }

    .audio-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px;
      font-size: 12px;
      color: #888888;
    }

    .footer {
      text-align: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid #333333;
      color: #666666;
      font-size: 14px;
    }

    .footer a {
      color: #ff0000;
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .footer a:hover {
      color: #ff3333;
      text-shadow: 0 0 10px rgba(255, 0, 0, 0.3);
    }

    /* Success state */
    .status-success {
      color: #00ff00 !important;
      text-shadow: 0 0 10px rgba(0, 255, 0, 0.3);
    }

    /* Loading animation */
    .loading .loader {
      opacity: 1;
      display: inline-block;
    }

    /* Enhanced responsive design */
    @media (max-width: 768px) {
      body {
        padding: 20px;
      }
      
      .container {
        padding: 30px 20px;
      }
      
      .form-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }
      
      .title {
        font-size: 2rem;
      }
      
      .controls {
        flex-direction: column;
        align-items: stretch;
      }
      
      .status-container {
        margin-left: 0;
        justify-content: center;
      }
    }

    /* Enhanced button ripple effect */
    .btn::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    .btn:active::before {
      width: 300px;
      height: 300px;
    }

    /* Error message styling */
    .error-message {
      color: #ff4444;
      font-size: 14px;
      margin-top: 5px;
      display: none;
    }

    /* Added floating elements animation */
    .floating-element {
      position: absolute;
      width: 4px;
      height: 4px;
      background: rgba(255, 0, 0, 0.3);
      border-radius: 50%;
      animation: float 6s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); opacity: 0.3; }
      50% { transform: translateY(-20px) rotate(180deg); opacity: 0.8; }
    }
  </style>
</head>
<body>
  <!-- Added animated particle background -->
  <canvas id="particles-canvas"></canvas>
  
  <div class="main-container">
    <div class="container" id="card">
      <div class="header">
        <!-- Updated heading to OmniXForge TTS Studio -->
        <h1 class="title">OmniXForge TTS Studio</h1>
        <p class="subtitle">Transform your text into natural, expressive speech with advanced AI voices</p>
      </div>

      <div class="form-grid">
        <div class="form-group">
          <label class="label" for="voice">Voice Selection</label>
          <select class="select" id="voice"></select>
        </div>
        
        <div class="form-group">
          <label class="label" for="rate">Sample Rate (Hz)</label>
          <input class="input" id="rate" type="number" value="24000" min="8000" max="48000" step="1000" />
        </div>
        
        <div class="form-group full-width">
          <label class="label" for="text">Text to Speech</label>
          <textarea class="textarea" id="text" placeholder="Enter the text you want to convert to speech...">Welcome to OmniXForge TTS Studio. Experience the future of text-to-speech technology with our advanced AI voices.</textarea>
        </div>
      </div>

      <!-- Custom audio player replacing default browser controls -->
      <div class="custom-audio-player" id="playerWrap">
        <div class="audio-controls">
          <button class="play-pause-btn" id="playPauseBtn">
            <svg id="playIcon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
            <svg id="pauseIcon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" style="display: none;">
              <rect x="6" y="4" width="4" height="16"></rect>
              <rect x="14" y="4" width="4" height="16"></rect>
            </svg>
          </button>
          
          <div class="time-display" id="timeDisplay">0:00 / 0:00</div>
          
          <div class="volume-control">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="#cccccc" stroke-width="2">
              <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
              <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
            </svg>
            <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="100">
          </div>
        </div>
        
        <div class="progress-container" id="progressContainer">
          <div class="progress-bar" id="progressBar"></div>
        </div>
        
        <div class="audio-info">
          <span id="audioTitle">AI Generated Speech</span>
          <span id="audioFormat">WAV Audio</span>
        </div>
        
        <audio id="audio" preload="none" style="display: none;"></audio>
      </div>

      <div class="controls">
        <button class="btn btn-primary" id="speak">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
            <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
            <path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>
          </svg>
          GENERATE & PLAY
        </button>
        
        <button class="btn btn-secondary" id="download">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7,10 12,15 17,10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
          </svg>
          DOWNLOAD
        </button>
        
        <div class="status-container">
          <div class="loader" id="loader"></div>
          <div class="status-text" id="status">Ready to generate</div>
        </div>
      </div>

      <!-- Removed FastAPI line from footer -->
      <div class="footer">
        <p>Made with ❤️ by <a href="https://github.com/iamkavy47" target="_blank" rel="noopener noreferrer">Kavy Porwal</a></p>
      </div>
    </div>
  </div>

<script>
  // Voice data
  const voices = [
    {"name": "Zephyr", "style": "Bright"},
    {"name": "Puck", "style": "Upbeat"},
    {"name": "Charon", "style": "Informative"},
    {"name": "Kore", "style": "Firm"},
    {"name": "Fenrir", "style": "Excitable"},
    {"name": "Leda", "style": "Youthful"},
    {"name": "Orus", "style": "Firm"},
    {"name": "Aoede", "style": "Breezy"},
    {"name": "Callirrhoe", "style": "Easy-going"},
    {"name": "Autonoe", "style": "Bright"},
    {"name": "Enceladus", "style": "Breathy"},
    {"name": "Iapetus", "style": "Clear"},
    {"name": "Umbriel", "style": "Easy-going"},
    {"name": "Algieba", "style": "Smooth"},
    {"name": "Despina", "style": "Smooth"},
    {"name": "Erinome", "style": "Clear"},
    {"name": "Alnilam", "style": "Firm"},
    {"name": "Schedar", "style": "Even"},
    {"name": "Gacrux", "style": "Mature"},
    {"name": "Pulcherrima", "style": "Forward"},
    {"name": "Achird", "style": "Friendly"},
    {"name": "Zubenelgenubi", "style": "Casual"},
    {"name": "Vindemiatrix", "style": "Gentle"},
    {"name": "Sadachbia", "style": "Lively"},
    {"name": "Sadaltager", "style": "Knowledgeable"},
    {"name": "Sulafat", "style": "Warm"}
  ];

  // DOM elements
  const voiceSelect = document.getElementById('voice');
  const textEl = document.getElementById('text');
  const speakBtn = document.getElementById('speak');
  const downloadBtn = document.getElementById('download');
  const status = document.getElementById('status');
  const loader = document.getElementById('loader');
  const audio = document.getElementById('audio');
  const playerWrap = document.getElementById('playerWrap');
  const card = document.getElementById('card');
  const playPauseBtn = document.getElementById('playPauseBtn');
  const playIcon = document.getElementById('playIcon');
  const pauseIcon = document.getElementById('pauseIcon');
  const timeDisplay = document.getElementById('timeDisplay');
  const progressContainer = document.getElementById('progressContainer');
  const progressBar = document.getElementById('progressBar');
  const volumeSlider = document.getElementById('volumeSlider');

  // Added particle system for background animation
  function initParticleSystem() {
    const canvas = document.getElementById('particles-canvas');
    const ctx = canvas.getContext('2d');
    
    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);
    
    const particles = [];
    const particleCount = 50;
    
    for (let i = 0; i < particleCount; i++) {
      particles.push({
        x: Math.random() * canvas.width,
        y: Math.random() * canvas.height,
        vx: (Math.random() - 0.5) * 0.5,
        vy: (Math.random() - 0.5) * 0.5,
        size: Math.random() * 2 + 1,
        opacity: Math.random() * 0.5 + 0.1
      });
    }
    
    function animate() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      particles.forEach(particle => {
        particle.x += particle.vx;
        particle.y += particle.vy;
        
        if (particle.x < 0 || particle.x > canvas.width) particle.vx *= -1;
        if (particle.y < 0 || particle.y > canvas.height) particle.vy *= -1;
        
        ctx.beginPath();
        ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
        ctx.fillStyle = `rgba(255, 0, 0, ${particle.opacity})`;
        ctx.fill();
      });
      
      requestAnimationFrame(animate);
    }
    
    animate();
  }

  // Initialize voice options
  function initializeVoices() {
    voices.forEach(voice => {
      const option = document.createElement('option');
      option.value = voice.name;
      option.textContent = `${voice.name} — ${voice.style}`;
      voiceSelect.appendChild(option);
    });
  }

  // Enhanced GSAP animations with more sophisticated effects
  function initializeAnimations() {
    // Initial card animation with enhanced effects
    gsap.timeline()
      .from(card, {
        duration: 1.2,
        y: 60,
        opacity: 0,
        scale: 0.9,
        ease: "power3.out"
      })
      .from(".header .title", {
        duration: 0.8,
        y: 40,
        opacity: 0,
        ease: "power2.out"
      }, "-=0.6")
      .from(".header .subtitle", {
        duration: 0.8,
        y: 30,
        opacity: 0,
        ease: "power2.out"
      }, "-=0.4")
      .to(".form-group, .btn", {
        duration: 0.8,
        y: 0,
        opacity: 1,
        stagger: 0.15,
        ease: "power2.out"
      }, "-=0.3");
    
    // Added floating elements
    createFloatingElements();
  }

  // Create floating decorative elements
  function createFloatingElements() {
    for (let i = 0; i < 8; i++) {
      const element = document.createElement('div');
      element.className = 'floating-element';
      element.style.left = Math.random() * 100 + '%';
      element.style.top = Math.random() * 100 + '%';
      element.style.animationDelay = Math.random() * 6 + 's';
      card.appendChild(element);
    }
  }

  // Enhanced loading state with better animations
  function setLoading(isLoading) {
    if (isLoading) {
      document.body.classList.add('loading');
      status.textContent = 'Generating audio...';
      status.classList.remove('status-success');
      speakBtn.disabled = true;
      downloadBtn.disabled = true;
      
      // Enhanced button animation
      gsap.to(speakBtn, {
        duration: 0.3,
        scale: 0.95,
        yoyo: true,
        repeat: 1,
        ease: "power2.inOut"
      });
    } else {
      document.body.classList.remove('loading');
      speakBtn.disabled = false;
      downloadBtn.disabled = false;
    }
  }

  // Generate audio function
  async function generateAudio() {
    const voice = voiceSelect.value;
    const text = textEl.value.trim();
    
    if (!text) {
      alert('Please enter some text to convert to speech.');
      return;
    }

    setLoading(true);

    try {
      const response = await fetch('/api/tts', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ voice, text })
      });

      if (!response.ok) {
        throw new Error(`Server error: ${response.status}`);
      }

      const blob = await response.blob();
      const audioUrl = URL.createObjectURL(blob);
      
      // Set up audio player
      audio.src = audioUrl;
      audio.dataset.url = audioUrl;
      
      // Enhanced player animation
      gsap.to(playerWrap, {
        opacity: 1,
        y: 0,
        duration: 0.6,
        ease: 'power2.out',
        onStart: () => {
          playerWrap.style.display = 'block';
        }
      });
      
      // Auto-play audio
      try {
        await audio.play();
      } catch (playError) {
        console.log('Auto-play prevented by browser policy');
      }
      
      // Update status
      status.textContent = 'Audio generated successfully!';
      status.classList.add('status-success');
      
    } catch (error) {
      console.error('Generation failed:', error);
      alert(`Failed to generate audio: ${error.message}`);
      status.textContent = 'Generation failed';
      status.classList.remove('status-success');
    } finally {
      setLoading(false);
    }
  }

  // Enhanced download function with animation
  function downloadAudio() {
    const audioUrl = audio.dataset.url;
    
    if (!audioUrl) {
      alert('No audio available. Please generate audio first.');
      return;
    }

    const link = document.createElement('a');
    link.href = audioUrl;
    link.download = 'ai-tts-audio.wav';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);

    // Enhanced button animation
    gsap.to(downloadBtn, {
      duration: 0.3,
      scale: 0.95,
      yoyo: true,
      repeat: 1,
      ease: "power2.inOut"
    });
  }

  function togglePlayPause() {
    if (audio.paused) {
      audio.play();
    } else {
      audio.pause();
    }
  }

  function updatePlayPauseButton() {
    if (!audio.paused) {
      playIcon.style.display = 'none';
      pauseIcon.style.display = 'block';
    } else {
      playIcon.style.display = 'block';
      pauseIcon.style.display = 'none';
    }
  }

  function formatTime(seconds) {
    const mins = Math.floor(seconds / 60);
    const secs = Math.floor(seconds % 60);
    return `${mins}:${secs.toString().padStart(2, '0')}`;
  }

  function updateProgress() {
    if (audio.duration) {
      const progress = (audio.currentTime / audio.duration) * 100;
      progressBar.style.width = progress + '%';
      
      const currentTime = formatTime(audio.currentTime);
      const duration = formatTime(audio.duration);
      timeDisplay.textContent = `${currentTime} / ${duration}`;
    }
  }

  function setProgress(e) {
    const rect = progressContainer.getBoundingClientRect();
    const clickX = e.clientX - rect.left;
    const width = rect.width;
    const percentage = clickX / width;
    
    if (audio.duration) {
      audio.currentTime = percentage * audio.duration;
    }
  }

  function setVolume() {
    audio.volume = volumeSlider.value / 100;
  }

  audio.addEventListener('play', () => {
    updatePlayPauseButton();
  });

  audio.addEventListener('pause', () => {
    updatePlayPauseButton();
  });

  audio.addEventListener('timeupdate', updateProgress);
  audio.addEventListener('loadedmetadata', updateProgress);

  playPauseBtn.addEventListener('click', togglePlayPause);
  progressContainer.addEventListener('click', setProgress);
  volumeSlider.addEventListener('input', setVolume);

  // Event listeners
  speakBtn.addEventListener('click', generateAudio);
  downloadBtn.addEventListener('click', downloadAudio);

  // Keyboard shortcuts
  document.addEventListener('keydown', (e) => {
    if (e.ctrlKey || e.metaKey) {
      if (e.key === 'Enter') {
        e.preventDefault();
        generateAudio();
      }
    }
  });

  // Initialize the application with particle system
  document.addEventListener('DOMContentLoaded', () => {
    initializeVoices();
    initializeAnimations();
    initParticleSystem();
    
    // Set initial status
    status.textContent = 'Ready to generate';
  });

  // Auto-resize textarea
  textEl.addEventListener('input', function() {
    this.style.height = 'auto';
    this.style.height = Math.max(112, this.scrollHeight) + 'px';
  });
</script>
</body>
</html>
